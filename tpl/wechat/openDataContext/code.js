!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var a=e();for(var n in a)("object"==typeof exports?exports:t)[n]=a[n]}}(window,function(){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e,a){"use strict";e.__esModule=!0;var n=function(t){for(var e=arguments.length,a=Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];var r;if(window.hasOwnProperty("wx")&&window.wx.hasOwnProperty(t))return(r=window.wx)[t].apply(r,a)},r="${env}",o=0,i=0,u=0,l=0;function f(t){for(var e,a=arguments.length,n=Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];(e=console).log.apply(e,["WXRank:",t].concat(n))}function s(t){if("production"!=r){for(var e,a=arguments.length,n=Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];(e=console).log.apply(e,["WXRank:",t].concat(n))}}e.default={getOffestX:function(){return o},getOffestY:function(){return i},getDesignWidth:function(){return u},getDesignHeight:function(){return l},init:function(t){var e;f("init..."),f("wxrank version:4.0.0"),Laya.MiniAdpter.init(!0,!0),Laya.init(750,1334),e=function(e){try{"filedata"===e.isLoad?(Laya.MiniFileMgr.ziyuFileData[e.url]=e.data,Laya.loader.load(e.url)):"filenative"==e.isLoad?e.isAdd?Laya.MiniFileMgr.filesListObj[e.url]=e.data:delete Laya.MiniFileMgr.filesListObj[e.url]:(s("message:",e),e.action&&"initRank"===e.action&&e.data?(Laya.stage.width=e.data.width,Laya.stage.height=e.data.height,o=e.data.offsetX,i=e.data.offsetY,u=e.data.designWidth,l=e.data.designHeight,Laya.stage.frameRate=Laya.Stage.FRAME_SLOW,Laya.stage.scaleMode=Laya.Stage.SCALE_EXACTFIT):t&&t(e))}catch(t){s("Error",t)}},n("onMessage",function(t){e&&e(t)})},setUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("setUserCloudStorage",t)},getUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getUserCloudStorage",t)},removeUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("removeUserCloudStorage",t)},getFriendCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getFriendCloudStorage",t)},getGroupCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getGroupCloudStorage",t)},getUserInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getUserInfo",t)},printDebug:s,printLog:f}},function(t,e,a){"use strict";var n,r=(n=a(0))&&n.__esModule?n:{default:n},o=a(2);r.default.init(function(t){"showRank"===t.action&&t.data?(0,o.showRank)(t.data.ui):"hideRank"===t.action&&t.data?(0,o.hideRank)():"setRankKey"===t.action&&t.data?(0,o.setRankKey)(t.data.key,t.data.count,t.data.offset):"setRankScore"===t.action&&t.data&&(0,o.setRankScore)(t.data.key,t.data.score,t.data.extraData)})},function(t,e,a){"use strict";e.__esModule=!0,e.setRankKey=function(t,e,a){l=t,d=e,g=a,y()},e.setRankScore=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=[{key:t,value:JSON.stringify({wxgame:{score:e,update_time:Math.floor(Date.now()/1e3)},extraData:a})}];r.default.setUserCloudStorage({KVDataList:n,success:function(){t==l&&y()}})},e.showRank=function(t){f&&JSON.stringify(t)===JSON.stringify(f)||(f=t,function(){if(f)if(Laya.stage.destroyChildren(),f instanceof Array)f.forEach(function(t){var e=Laya.View.createComp(t);e&&((0,o.bindView)(e,u),Laya.stage.addChild(e))});else{var t=Laya.View.createComp(f);t&&(t.x=r.default.getOffestX(),t.y=r.default.getOffestY(),(0,o.bindView)(t,u),Laya.stage.addChild(t))}}()),y()},e.hideRank=function(){f=null,Laya.stage.destroyChildren()};var n,r=(n=a(0))&&n.__esModule?n:{default:n},o=a(3),i=a(4),u={},l=null,f=null,s=!0,c=null,d=100,g=0;function y(){c||(c=setTimeout(function(){c=null,f&&l&&s&&(s=!1,(0,i.fetchRankData)(l,d,g,function(t){r.default.printDebug("rankData:",t),u=t,s=!0;for(var e=0;e<Laya.stage.numChildren;e++)(0,o.bindView)(Laya.stage.getChildAt(e),u)}))},200))}},function(t,e,a){"use strict";e.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}function o(t,e){var a=e.split("|"),n=a[0],o=r(t);t?t[n]?o=r(t[n]):n.split(".").forEach(function(t){o=null!==o&&void 0!==o&&null!==o[t]&&void 0!==o[t]?r(o[t]):null}):o=null;for(var i=[],u=1;u<a.length;u+=2){var l=a[u],f=a.length>u+1?a[u+1]:"";i.push({action:l,target:f})}for(var s=null,c=0;c<i.length;c++){var d=i[c],g=d.action,y=d.target;"default"===g&&(s=y),null!==o&&void 0!==o?"eq"===g&&y!==o.toString()||"neq"===g&&y===o.toString()||"gt"===g&&o<=y||"egt"===g&&o<y||"lt"===g&&o>=y||"elt"===g&&o>y||"like"===g&&o.toString().indexOf(y)<0?o=null:"sub"===g?o.toString().length>Number(y)&&(o=o.toString().substr(0,Number(y))+"..."):"append"===g&&(o=o.toString()+y):o=null}return null===o&&(o=s),o}e.bindView=function t(e,a){for(var i=this,u=r(a),l=0;l<e.numChildren;l++){var f=e.getChildAt(l);if(f.name){var s=o(u,f.name);null!==s&&void 0!==s?(f.visible=!0,f instanceof Laya.List?function(){var e=f;e.array=[],e.repeatX>1&&!e.hScrollBarSkin&&(e.hScrollBarSkin=null),e.repeatY>1&&!e.vScrollBarSkin&&(e.vScrollBarSkin=null),e.renderHandler=Laya.Handler.create(i,function(a,r){var o=e.array[r];"object"===(void 0===o?"undefined":n(o))&&Object.assign(o,{index:r}),t(a,o)},null,!1),e.array=s}():f instanceof Laya.FontClip?f.value=""+s:f instanceof Laya.Label?f.text=""+s:f instanceof Laya.Text?f.text=""+s:f instanceof Laya.Image?f.skin=s:f instanceof Laya.Box?t(f,s):f.value=s):f.visible=!1}}}},function(t,e,a){"use strict";e.__esModule=!0,e.fetchRankData=function(t,e,a,n){var r={};o(function(o){i(o,t,e,a,function(t){Object.assign(r,t),n&&n(r)})})};var n,r=(n=a(0))&&n.__esModule?n:{default:n},o=function(t){r.default.getUserInfo({openIdList:["selfOpenId"],success:function(e){var a=e.data[0],n={playerId:a.openId,nickname:a.nickName,avatarUrl:a.avatarUrl};t&&t(n)}})},i=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments[4];r.default.getFriendCloudStorage({keyList:[e],success:function(r){var i=[];r&&r.data&&r.data.length>0&&(i=r.data);var u,l=-1,f=null,s=null,c=i.map(function(t){var a={};t.KVDataList.forEach(function(t){a[t.key]=t.value});var n,r=t.openid,o=t.nickname,i=t.avatarUrl,u=0,l=0,f=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}(a[e])||{};return n=f.extraData||"",f.wxgame&&(l=f.wxgame.score||0,u=f.wxgame.update_time||0),{playerId:r,nickname:o,avatarUrl:i,score:l,timestamp:u,extraData:n}}).sort(function(t,e){return e.score-t.score}).splice(n,a).map(function(e,a){var n=e.nickname===t.nickname&&e.avatarUrl===t.avatarUrl;return n&&(s=e,l=a,f={score:e.score,extraData:e.extraData}),Object.assign(e,{self:n,rank:a+1}),e});u=l<=0?c.slice(0,3):c.slice(l-1,l+1),o&&o({selfInfo:t,rankList:c,rankSelf:s,selfData:f,rankThree:u})}})}}])});